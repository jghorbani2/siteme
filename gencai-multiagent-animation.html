<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GenCAI — Orchestrator Multiagent Storyboard</title>
<meta name="theme-color" content="#0b0f1a" />

<link rel="stylesheet" href="assets/style.css" />
<link rel="stylesheet" href="system_architecture/professional-theme.css" />

<style>
html,body{height:100%;margin:0}
body{background:#0b0f1a;color:#e7efff;font:14px/1.5 ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial}

.shell{display:grid;grid-template-columns:320px 1fr;gap:16px;padding:16px;height:100vh;box-sizing:border-box}
.sidebar{background:rgba(16,24,40,.85);border:1px solid #2b3b57;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:12px;overflow:auto}
.sidebar h1{margin:0;font:800 18px/1.2 ui-sans-serif;color:#9cc2ff}
.sidebar .desc{color:#cfe0ff}
.controls{display:flex;gap:8px;flex-wrap:wrap}
.btn{cursor:pointer;border:1px solid #2b3b57;background:#152038;color:#e7efff;border-radius:8px;padding:8px 12px;font-weight:700}
.btn:hover{border-color:#60a5fa;box-shadow:0 0 0 2px rgba(96,165,250,.15)}
.stage-list{display:flex;flex-direction:column;gap:8px}
.stage-item{display:flex;align-items:center;gap:8px;padding:8px;border-radius:8px;border:1px solid #2b3b57}
.stage-item.active{border-color:#60a5fa;background:rgba(96,165,250,.08)}
.stage-item .dot{width:10px;height:10px;border-radius:50%;background:#64748b}
.stage-item.active .dot{background:#60a5fa}

.canvas{background:radial-gradient(1200px 800px at 50% 10%,#0e1628 0%,#0b0f1a 60%,#090e18 100%);border:1px solid #2b3b57;border-radius:12px;padding:16px;position:relative}
.panel{position:absolute;inset:16px;overflow:auto;padding-top:56px}

.legend{position:absolute;right:8px;top:8px;background:rgba(18,26,44,.85);border:1px solid #334155;border-radius:10px;padding:8px 10px;display:flex;gap:10px;align-items:center}
.legend-item{display:flex;align-items:center;gap:6px;font-size:12px;color:#cfe0ff}
.swatch{width:10px;height:10px;border-radius:3px}
.c-el{background:#60a5fa}.c-cs{background:#f59e0b}.c-pl{background:#a855f7}.c-flow{background:#06b6d4}.c-win{background:#10b981}

.hint{color:#9fb3d1;font-size:12px}

@media (max-width:980px){.shell{grid-template-columns:1fr}}
</style>
</head>
<body>
  <a class="skip" href="#main">Skip to content</a>

  <header class="site-header" role="banner" aria-label="Site header">
    <div class="container header-inner">
      <a class="brand" href="index.html" aria-label="Home"><span>Javad Ghorbani</span></a>
      <nav class="nav" aria-label="Primary">
        <ul>
          <li class="nav-dropdown">
            <a href="index.html#projects">Projects</a>
            <div class="dropdown-menu">
              <div class="dropdown-item has-sub">
                <a href="ai-projects.html">Artificial Intelligence</a>
                <div class="dropdown-submenu">
                  <a href="ai-projects.html#overview">Overview</a>
                  <a href="#ai-demo">Live Demo</a>
                  <a href="#ai-code">Source Code</a>
                  <a href="#ai-paper">Research Paper</a>
                </div>
              </div>
              <div class="dropdown-item has-sub">
                <a href="geomechanics-projects.html">Computational Geomechanics</a>
                <div class="dropdown-submenu">
                  <a href="geomechanics-projects.html#overview">Overview</a>
                  <a href="#geomechanics-sim">Interactive Simulation</a>
                  <a href="#geomechanics-docs">Documentation</a>
                  <a href="#geomechanics-research">Research</a>
                </div>
              </div>
            </div>
          </li>
          <li><a href="index.html#about">About</a></li>
          <li><a class="btn btn-sm" href="index.html#contact-me">Contact</a></li>
        </ul>
      </nav>
      <button class="nav-toggle" aria-expanded="false" aria-controls="nav-drawer" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
    </div>
    <div id="nav-drawer" class="nav-drawer" hidden>
      <a href="index.html#projects">Projects</a>
      <div class="drawer-submenu">
        <a href="ai-projects.html">• Artificial Intelligence</a>
        <a href="geomechanics-projects.html">• Computational Geomechanics</a>
      </div>
      <a href="index.html#about">About</a>
      <a href="index.html#contact-me" class="btn btn-sm">Contact</a>
    </div>
  </header>

  <script>
    (function(){
      const btn = document.querySelector('.nav-toggle');
      const drawer = document.getElementById('nav-drawer');
      if (!btn || !drawer) return;
      function open(){ drawer.hidden = false; btn.setAttribute('aria-expanded','true'); document.documentElement.style.overflow = 'hidden'; }
      function close(){ drawer.hidden = true; btn.setAttribute('aria-expanded','false'); document.documentElement.style.overflow = ''; }
      btn.addEventListener('click', () => drawer.hidden ? open() : close());
      drawer.addEventListener('click', (e) => { if (e.target && e.target.tagName === 'A') close(); });
      window.addEventListener('keydown', e => { if (e.key === 'Escape' && !drawer.hidden) close(); });
    })();
  </script>

  <main id="main" style="height:100vh; margin:0;">
    <header style="text-align:center; padding:12px 16px;">
      <div class="back-row" style="display:flex; justify-content:space-between; align-items:center; margin: 0 0 6px;">
        <h2 style="margin:0; background: linear-gradient(135deg, #7bd4ff, #8ef5c0); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;">GenCAI — Multiagent Constitutive Builder (Orchestrator)</h2>
        <a class="btn btn-ghost" href="ai-projects.html">Back</a>
      </div>
      <h3 style="margin:10px 0 6px;">Abstract</h3>
      <p class="lede" style="max-width:80ch; margin:0 auto; color:#cfe0ff;">Soil constitutive models are essential for predicting geomaterial behavior under various loading conditions, serving as a foundation for reliable and efficient construction and infrastructure design. Advanced plasticity models can enhance predictive accuracy in geotechnical applications involving complex environmental and mechanical loads. However, the development, calibration, and numerical implementation of these models are often challenging, time‑intensive, and susceptible to subjectivity. This study presents a novel framework called ‘generative computational artificial intelligence,’ designed to automate the formulation, calibration, and numerical implementation of constitutive models. Focusing specifically on SANISAND plasticity, the framework features a collection of cooperative agents that autonomously handle experimental data as inputs, develop constitutive models, calibrate parameters, and generate implementation code, all with minimal human intervention. The methodology involves several core stages: (1) feature extraction to identify critical behaviors, such as elasticity and critical state, from data; (2) parameter identification to optimize parameters aligned with these behaviors; (3) model ranking to assess the performance of candidate models; (4) construction and implementation of the final constitutive model based on ranked candidates; and (5) final optimization using particle swarm optimization.</p>
      <p class="micro" style="max-width:80ch; margin:8px auto 0; color:#a9b8d6;">Animation guide: The left sidebar lists stages. The canvas panel shows (1) Feature Probing extracting Elasticity/Critical State/Plasticity, (2) Parameter Identification filling parameter chips per candidate, (3) Model Ranking computing RMSE and selecting winners, (4) Formulation placing SANISAND blocks from winners, and (5) PSO converging to a global best.</p>
      <h3 style="margin:12px 0 6px;">Publications & Repositories</h3>
      <div class="btn-row" style="display:flex; gap:8px; justify-content:center; margin-top:8px;">
        <a id="btnPubs" class="btn" href="#" style="text-decoration:none; border:1px solid #2b3b57; background:#152038; color:#e7efff; border-radius:8px; padding:8px 12px; font-weight:700;">Publications</a>
        <a id="btnRepos" class="btn" href="#" style="text-decoration:none; border:1px solid #2b3b57; background:transparent; color:#e7efff; border-radius:8px; padding:8px 12px; font-weight:700;">Repositories</a>
      </div>
      <div id="pubList" class="card" style="display:none; margin:10px auto; max-width:880px;"></div>
      <div id="repoList" class="card" style="display:none; margin:10px auto; max-width:880px;"></div>
    </header>

<div class="shell">
  <aside class="sidebar">
    <h1>GenCAI — Orchestrator Storyboard</h1>
    <p class="desc">Step-by-step visualisation of the orchestrated agents.</p>
    
    <div class="stage-list" id="stageList"></div>
    <p class="hint">Use ←/→ to step, Space to play/pause, R to reset.</p>
  </aside>

  <main class="canvas">
    <div class="panel" id="panel"></div>
  </main>
</div>

<script>
(function(){
  const panel = document.getElementById('panel');
  const stageList = document.getElementById('stageList');
  const btnPubs = document.getElementById('btnPubs');
  const btnRepos = document.getElementById('btnRepos');
  const pubList = document.getElementById('pubList');
  const repoList = document.getElementById('repoList');

  if (btnPubs && pubList){
    const pubsHtml = [
      'Ghorbani, J. and Nazem, M., 2025. Toward automated formulation, calibration, and implementation of soil models: A generative computational AI framework for SANISAND plasticity. Computers and Geotechnics, 185, p.107330.',
      'Ghorbani, J. and Airey, D.W., 2021. Modelling stress-induced anisotropy in multi-phase granular soils. Computational Mechanics, 67(2), pp.497-521.',
      'Ghorbani, J., Airey, D.W., Carter, J.P. and Nazem, M., 2021. Unsaturated soil dynamics: Finite element solution including stress-induced anisotropy. Computers and Geotechnics, 133, p.104062.'
    ].map(s=>`<div style="margin:6px 0;">${s}</div>`).join('');
    btnPubs.addEventListener('click', (e)=>{ e.preventDefault(); pubList.style.display = (pubList.style.display==='none')?'block':'none'; if (pubList.style.display==='block'){ pubList.innerHTML = pubsHtml; }});
  }

  if (btnRepos && repoList){
    const reposHtml = [
      { title:'SANISAND Model — C++ Implementation', href:'https://github.com/jghorbani2/SANISAND_rep' }
    ].map(r=>`<div style=\"margin:6px 0;\"><a href=\"${r.href}\" target=\"_blank\" rel=\"noopener\">${r.title}</a></div>`).join('');
    btnRepos.addEventListener('click', (e)=>{ e.preventDefault(); repoList.style.display = (repoList.style.display==='none')?'block':'none'; if (repoList.style.display==='block'){ repoList.innerHTML = reposHtml; }});
  }
  

  const stages = [
    {
      id:'probing',
      title:'1) Feature Probing Agent',
      summary:'Receive raw data (e.g., triaxial tests) and extract Elasticity, Critical State, Plasticity.',
      render:()=>`
        <div class="legend">
          <div class="legend-item"><span class="swatch c-el"></span>Elasticity</div>
          <div class="legend-item"><span class="swatch c-cs"></span>Critical State</div>
          <div class="legend-item"><span class="swatch c-pl"></span>Plasticity</div>
          <div class="legend-item"><span class="swatch c-flow"></span>Data Flow</div>
        </div>
        <svg viewBox="0 0 1000 540" width="100%" height="520">
          <g transform="translate(120,260)">
            <rect x="-80" y="-60" width="160" height="120" rx="14" fill="#16243f" stroke="#334155" stroke-width="2"/>
            <text x="0" y="-16" text-anchor="middle" fill="#cfe0ff" font-weight="700" font-size="16">Raw Data</text>
            <text x="0" y="6" text-anchor="middle" fill="#9fb3d1" font-size="12">Triaxial tests</text>
            <text x="0" y="24" text-anchor="middle" fill="#9fb3d1" font-size="12">Lab curves</text>
            <text x="0" y="42" text-anchor="middle" fill="#9fb3d1" font-size="12">Sensor logs</text>
          </g>
          <g transform="translate(400,260)">
            <circle r="56" fill="#0f172a" stroke="#475569" stroke-width="3"/>
            <circle r="38" fill="none" stroke="#60a5fa" stroke-width="4">
              <animate attributeName="r" values="32;42;32" dur="2s" repeatCount="indefinite"/>
            </circle>
            <text x="0" y="6" text-anchor="middle" fill="#cfe0ff" font-weight="700">Probing</text>
          </g>
          <g transform="translate(720,170)">
            <rect x="-110" y="-30" width="220" height="60" rx="12" fill="#14233e" stroke="#60a5fa" stroke-width="2"/>
            <text x="0" y="4" text-anchor="middle" fill="#cfe0ff" font-weight="700" font-size="16">Elasticity</text>
          </g>
          <g transform="translate(720,260)">
            <rect x="-110" y="-30" width="220" height="60" rx="12" fill="#14233e" stroke="#f59e0b" stroke-width="2"/>
            <text x="0" y="4" text-anchor="middle" fill="#cfe0ff" font-weight="700" font-size="16">Critical State</text>
          </g>
          <g transform="translate(720,350)">
            <rect x="-110" y="-30" width="220" height="60" rx="12" fill="#14233e" stroke="#a855f7" stroke-width="2"/>
            <text x="0" y="4" text-anchor="middle" fill="#cfe0ff" font-weight="700" font-size="16">Plasticity</text>
          </g>
          <path d="M200,260 C280,260 320,260 344,260" fill="none" stroke="#06b6d4" stroke-width="6" stroke-linecap="round">
            <animate attributeName="stroke-dasharray" values="0 300;300 300" dur="1.6s" repeatCount="indefinite"/>
          </path>
          <path d="M456,260 C560,200 600,180 610,170" fill="none" stroke="#60a5fa" stroke-width="6" stroke-linecap="round">
            <animate attributeName="stroke-dasharray" values="0 300;300 300" dur="1.8s" repeatCount="indefinite"/>
          </path>
          <path d="M456,260 C560,260 600,250 610,250" fill="none" stroke="#f59e0b" stroke-width="6" stroke-linecap="round">
            <animate attributeName="stroke-dasharray" values="0 300;300 300" dur="1.9s" repeatCount="indefinite"/>
          </path>
          <path d="M456,260 C560,320 600,340 610,350" fill="none" stroke="#a855f7" stroke-width="6" stroke-linecap="round">
            <animate attributeName="stroke-dasharray" values="0 300;300 300" dur="2.0s" repeatCount="indefinite"/>
          </path>
        </svg>
      `
    },
    {
      id:'identification',
      title:'2) Parameter Identification Agent',
      summary:'Estimate parameters θ for every candidate using probed data. Outputs fitted candidates (no RMSE).',
      render:()=>`
        <div class="legend">
          <div class="legend-item"><span class="swatch" style="background:#ef4444"></span>Undetermined θ</div>
          <div class="legend-item"><span class="swatch" style="background:#10b981"></span>Calibrated θ</div>
          <div class="legend-item"><span class="swatch c-flow"></span>Probed data</div>
        </div>
        <svg viewBox="0 0 1000 520" width="100%" height="520">
          <defs>
            <marker id="arrowBlue" viewBox="0 0 6 6" refX="5" refY="3" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
              <path d="M0,0 L6,3 L0,6 Z" fill="#06b6d4"/>
            </marker>
          </defs>
          <g transform="translate(120,72)"><rect x="0" y="0" width="300" height="44" rx="10" fill="#16243f" stroke="#334155"/><text x="150" y="26" text-anchor="middle" fill="#cfe0ff" font-size="13">Probed Data → {Elasticity, Critical State, Plasticity}</text></g>
          
          <!-- Elasticity lane: candidates with parameter chips filling -->
          <g transform="translate(240,148)">
            <rect x="-140" y="0" width="120" height="58" rx="10" fill="#16243f" stroke="#334155"/>
            <text x="-80" y="34" text-anchor="middle" fill="#cfe0ff" font-size="12">Probed Elasticity</text>
            <text x="0" y="-10" fill="#60a5fa" font-weight="800">Elasticity</text>
            <rect x="0" y="0" width="760" height="58" rx="10" fill="#0f172a" stroke="#334155"/>
            <g transform="translate(16,10)"><rect width="220" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 1</text><g transform="translate(110,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.6s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.6s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.9s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.9s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g><g transform="translate(64,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.2s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.2s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ3</text></g></g></g>
            <g transform="translate(256,10)"><rect width="220" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 2</text><g transform="translate(110,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.4s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.4s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.8s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.8s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g><g transform="translate(64,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.1s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.1s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ3</text></g></g></g>
            <g transform="translate(496,10)"><rect width="220" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 3</text><g transform="translate(110,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.7s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.7s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.0s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.0s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g><g transform="translate(64,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.3s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.3s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ3</text></g></g></g>
            <path id="inflow-el" d="M-20,29 L0,29" fill="none" stroke="#06b6d4" stroke-width="3" stroke-linecap="round" marker-end="url(#arrowBlue)"><animate attributeName="stroke-dasharray" values="0 20;20 20" dur="1.2s" repeatCount="indefinite"/></path>
          </g>
          <!-- Critical State lane -->
          <g transform="translate(240,232)">
            <rect x="-140" y="0" width="120" height="58" rx="10" fill="#16243f" stroke="#334155"/>
            <text x="-80" y="34" text-anchor="middle" fill="#cfe0ff" font-size="12">Probed Critical</text>
            <text x="0" y="-10" fill="#f59e0b" font-weight="800">Critical State</text>
            <rect x="0" y="0" width="760" height="58" rx="10" fill="#0f172a" stroke="#334155"/>
            <g transform="translate(16,10)"><rect width="240" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 1</text><g transform="translate(130,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.6s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.6s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.9s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.9s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g></g></g>
            <g transform="translate(272,10)"><rect width="240" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 2</text><g transform="translate(130,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.5s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.5s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.8s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.8s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g></g></g>
            <path id="inflow-cs" d="M-20,29 L0,29" fill="none" stroke="#06b6d4" stroke-width="3" stroke-linecap="round" marker-end="url(#arrowBlue)"><animate attributeName="stroke-dasharray" values="0 20;20 20" dur="1.2s" repeatCount="indefinite"/></path>
          </g>
          <!-- Plasticity lane -->
          <g transform="translate(240,334)">
            <rect x="-140" y="0" width="120" height="58" rx="10" fill="#16243f" stroke="#334155"/>
            <text x="-80" y="34" text-anchor="middle" fill="#cfe0ff" font-size="12">Probed Plasticity</text>
            <text x="0" y="-10" fill="#a855f7" font-weight="800">Plasticity</text>
            <rect x="0" y="0" width="760" height="58" rx="10" fill="#0f172a" stroke="#334155"/>
            <g transform="translate(16,10)"><rect width="220" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 1</text><g transform="translate(110,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.6s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.6s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.9s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.9s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g><g transform="translate(64,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.2s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.2s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ3</text></g></g></g>
            <g transform="translate(256,10)"><rect width="220" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 2</text><g transform="translate(110,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.5s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.5s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.8s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.8s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g><g transform="translate(64,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.1s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.1s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ3</text></g></g></g>
            <g transform="translate(496,10)"><rect width="220" height="38" rx="8" fill="#14233e" stroke="#334155"/><text x="10" y="24" fill="#cfe0ff" font-size="12">Candidate 3</text><g transform="translate(110,11)"><g transform="translate(0,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="0.7s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="0.7s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ1</text></g><g transform="translate(32,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.0s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.0s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ2</text></g><g transform="translate(64,0)"><rect width="26" height="16" rx="4" fill="#ef4444" opacity="0.6"><animate attributeName="fill" values="#ef4444;#10b981" begin="1.3s" dur="0.5s" fill="freeze"/><animate attributeName="opacity" values="0.6;1" begin="1.3s" dur="0.5s" fill="freeze"/></rect><text x="13" y="12" text-anchor="middle" fill="#0b0f1a" font-size="11">θ3</text></g></g></g>
            <path id="inflow-pl" d="M-20,29 L0,29" fill="none" stroke="#06b6d4" stroke-width="3" stroke-linecap="round" marker-end="url(#arrowBlue)"><animate attributeName="stroke-dasharray" values="0 20;20 20" dur="1.2s" repeatCount="indefinite"/></path>
          </g>
          <g transform="translate(720,460)"><rect x="-110" y="-20" width="240" height="40" rx="10" fill="#122035" stroke="#334155"/><text x="-98" y="4" fill="#cfe0ff" font-size="12">Output: fitted candidates (θ)</text><text x="-98" y="18" fill="#9fb3d1" font-size="11">Sent to Agent 3 (ranking)</text></g>
        </svg>
      `
    },
    {
      id:'ranking',
      title:'3) Model Ranking Agent',
      summary:'Compute RMSE per candidate using fitted params; select winners per aspect.',
      render:()=>`
        <div class="legend">
          <div class="legend-item"><span class="swatch c-flow"></span>Residuals/data flow</div>
          <div class="legend-item"><span class="swatch c-win"></span>Winner</div>
        </div>
        <svg viewBox="0 0 1000 520" width="100%" height="520">
          <g transform="translate(120,70)"><rect x="0" y="0" width="260" height="40" rx="10" fill="#16243f" stroke="#334155"/><text x="130" y="24" text-anchor="middle" fill="#cfe0ff" font-size="12">Fitted candidates from Agent 2</text></g>
          <g transform="translate(820,120)"><rect x="-80" y="-24" width="160" height="48" rx="10" fill="#0f172a" stroke="#334155"/><text x="0" y="4" text-anchor="middle" fill="#cfe0ff" font-weight="800" font-size="12">RMSE Engine</text></g>
          <g transform="translate(80,190)"><text x="0" y="-12" fill="#60a5fa" font-weight="800">Elasticity</text><rect x="0" y="0" width="480" height="70" rx="12" fill="#0f172a" stroke="#334155"/><g transform="translate(10,10)"><rect x="0" y="8" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="8" width="120" height="10" rx="5" fill="#06b6d4"/><rect x="0" y="26" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="26" width="90" height="10" rx="5" fill="#06b6d4"><animate attributeName="width" values="105;90;105" dur="2.6s" repeatCount="indefinite"/></rect><rect x="0" y="44" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="44" width="150" height="10" rx="5" fill="#06b6d4"/></g></g>
          <g transform="translate(80,280)"><text x="0" y="-12" fill="#f59e0b" font-weight="800">Critical State</text><rect x="0" y="0" width="480" height="70" rx="12" fill="#0f172a" stroke="#334155"/><g transform="translate(10,10)"><rect x="0" y="8" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="8" width="80" height="10" rx="5" fill="#06b6d4"/><rect x="0" y="26" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="26" width="110" height="10" rx="5" fill="#06b6d4"/></g></g>
          <g transform="translate(80,370)"><text x="0" y="-12" fill="#a855f7" font-weight="800">Plasticity</text><rect x="0" y="0" width="480" height="70" rx="12" fill="#0f172a" stroke="#334155"/><g transform="translate(10,10)"><rect x="0" y="8" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="8" width="160" height="10" rx="5" fill="#06b6d4"/><rect x="0" y="26" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="26" width="140" height="10" rx="5" fill="#06b6d4"/><rect x="0" y="44" width="120" height="10" rx="5" fill="#334155"/><rect x="0" y="44" width="130" height="10" rx="5" fill="#06b6d4"/></g></g>
          <!-- Right-side RMSE labels -->
          <g transform="translate(600,190)">
            <text x="0" y="-12" fill="#60a5fa" font-weight="800">Elasticity</text>
            <text x="0" y="8" fill="#cfe0ff" font-size="12">C1: RMSE=0.12</text>
            <text x="0" y="26" fill="#cfe0ff" font-size="12">C2: RMSE=0.09</text>
            <text x="0" y="44" fill="#cfe0ff" font-size="12">C3: RMSE=0.15</text>
          </g>
          <g transform="translate(600,280)">
            <text x="0" y="-12" fill="#f59e0b" font-weight="800">Critical State</text>
            <text x="0" y="8" fill="#cfe0ff" font-size="12">C1: RMSE=0.08</text>
            <text x="0" y="26" fill="#cfe0ff" font-size="12">C2: RMSE=0.11</text>
          </g>
          <g transform="translate(600,370)">
            <text x="0" y="-12" fill="#a855f7" font-weight="800">Plasticity</text>
            <text x="0" y="8" fill="#cfe0ff" font-size="12">C1: RMSE=0.20</text>
            <text x="0" y="26" fill="#cfe0ff" font-size="12">C2: RMSE=0.14</text>
            <text x="0" y="44" fill="#cfe0ff" font-size="12">C3: RMSE=0.18</text>
          </g>
          <!-- Winner podiums (one per aspect) -->
          <g transform="translate(820,260)"><rect x="-80" y="0" width="160" height="40" fill="#122035" stroke="#334155"/><rect x="-80" y="-40" width="160" height="40" fill="#14233e" stroke="#334155"/><rect x="-80" y="-80" width="160" height="40" fill="#1a2332" stroke="#334155"/><text x="0" y="-100" text-anchor="middle" fill="#cfe0ff" font-weight="800">Elasticity Winner</text><g transform="translate(0,-60)"><circle r="14" fill="#10b981"><animate attributeName="cy" values="0;-18;0" dur="2.2s" repeatCount="indefinite"/></circle><text x="0" y="36" text-anchor="middle" fill="#10b981" font-weight="800">Candidate 2</text></g></g>
          <g transform="translate(820,380)"><rect x="-80" y="0" width="160" height="40" fill="#122035" stroke="#334155"/><rect x="-80" y="-40" width="160" height="40" fill="#1a2332" stroke="#334155"/><rect x="-80" y="-80" width="160" height="40" fill="#14233e" stroke="#334155"/><text x="0" y="-100" text-anchor="middle" fill="#cfe0ff" font-weight="800">Critical State Winner</text><g transform="translate(0,-60)"><circle r="14" fill="#10b981"><animate attributeName="cy" values="0;-18;0" dur="2.2s" begin="0.35s" repeatCount="indefinite"/></circle><text x="0" y="36" text-anchor="middle" fill="#10b981" font-weight="800">Candidate 1</text></g></g>
          <g transform="translate(820,500)"><rect x="-80" y="0" width="160" height="40" fill="#14233e" stroke="#334155"/><rect x="-80" y="-40" width="160" height="40" fill="#122035" stroke="#334155"/><rect x="-80" y="-80" width="160" height="40" fill="#1a2332" stroke="#334155"/><text x="0" y="-100" text-anchor="middle" fill="#cfe0ff" font-weight="800">Plasticity Winner</text><g transform="translate(0,-60)"><circle r="14" fill="#10b981"><animate attributeName="cy" values="0;-18;0" dur="2.2s" begin="0.7s" repeatCount="indefinite"/></circle><text x="0" y="36" text-anchor="middle" fill="#10b981" font-weight="800">Candidate 2</text></g></g>
          
        </svg>
      `
    },
    {
      id:'formulation',
      title:'4) Model Formulation Agent',
      summary:'Place SANISAND building blocks based on winners (E2, CS1, PL2).',
      render:()=>`
        <div class="legend">
          <div class="legend-item"><span class="swatch c-el"></span>Elasticity block</div>
          <div class="legend-item"><span class="swatch c-cs"></span>Critical State block</div>
          <div class="legend-item"><span class="swatch c-pl"></span>Plasticity block</div>
        </div>
        <svg viewBox="0 0 1000 520" width="100%" height="520">
          <g transform="translate(200,200)"><rect x="0" y="0" width="600" height="260" rx="18" fill="#0f172a" stroke="#334155" stroke-width="3"/><text x="20" y="32" fill="#cfe0ff" font-weight="800" font-size="18">SANISAND Template</text><g transform="translate(20,70)"><rect x="0" y="0" width="560" height="46" rx="10" fill="#122035" stroke="#334155"/><text x="12" y="28" fill="#9fb3d1">Elasticity slot</text></g><g transform="translate(20,130)"><rect x="0" y="0" width="560" height="46" rx="10" fill="#122035" stroke="#334155"/><text x="12" y="28" fill="#9fb3d1">Critical State slot</text></g><g transform="translate(20,190)"><rect x="0" y="0" width="560" height="46" rx="10" fill="#122035" stroke="#334155"/><text x="12" y="28" fill="#9fb3d1">Plasticity slot</text></g></g>
          <g><rect x="60" y="268" width="140" height="46" rx="10" fill="#60a5fa" stroke="#3b82f6"/><text x="130" y="296" text-anchor="middle" fill="#0b0f1a" font-weight="800">E2</text><animateTransform attributeName="transform" type="translate" from="0 0" to="160 0" dur="2s" fill="freeze"/></g>
          <g><rect x="60" y="328" width="140" height="46" rx="10" fill="#f59e0b" stroke="#d97706"/><text x="130" y="356" text-anchor="middle" fill="#0b0f1a" font-weight="800">CS1</text><animateTransform attributeName="transform" type="translate" from="0 0" to="160 0" begin="0.4s" dur="2s" fill="freeze"/></g>
          <g><rect x="60" y="388" width="140" height="46" rx="10" fill="#a855f7" stroke="#7c3aed"/><text x="130" y="416" text-anchor="middle" fill="#0b0f1a" font-weight="800">PL2</text><animateTransform attributeName="transform" type="translate" from="0 0" to="160 0" begin="0.8s" dur="2s" fill="freeze"/></g>
        </svg>
      `
    },
    {
      id:'calibration',
      title:'5) Global Calibration Agent (PSO)',
      summary:'Swarm converges to global best for final optimization (distinct from local fits).',
      render:()=>`
        <div class="legend">
          <div class="legend-item"><span class="swatch c-flow"></span>Particle trajectory</div>
          <div class="legend-item"><span class="swatch c-win"></span>Global best</div>
        </div>
        <svg viewBox="0 0 1000 520" width="100%" height="520">
          <defs><radialGradient id="space" cx="50%" cy="50%" r="70%"><stop offset="0%" stop-color="#0b1327"/><stop offset="100%" stop-color="#0a1223"/></radialGradient></defs>
          <rect x="100" y="120" width="680" height="280" rx="16" fill="url(#space)" stroke="#334155" stroke-width="2"/>
          <text x="120" y="150" fill="#cfe0ff" font-weight="700">Parameter Search Space</text>
          <g transform="translate(700,220)"><circle r="10" fill="#10b981"><animate attributeName="r" values="8;12;8" dur="1.8s" repeatCount="indefinite"/></circle><text x="14" y="4" fill="#cfe0ff" font-size="12">Global best</text></g>
          <g>
            <circle cx="160" cy="360" r="5" fill="#06b6d4"><animate attributeName="cx" values="160;300;460;640;690" dur="7s" repeatCount="indefinite"/><animate attributeName="cy" values="360;300;260;240;220" dur="7s" repeatCount="indefinite"/></circle>
            <circle cx="220" cy="180" r="5" fill="#06b6d4"><animate attributeName="cx" values="220;360;520;660;700" dur="7.5s" repeatCount="indefinite"/><animate attributeName="cy" values="180;200;210;215;220" dur="7.5s" repeatCount="indefinite"/></circle>
            <circle cx="260" cy="320" r="5" fill="#06b6d4"><animate attributeName="cx" values="260;380;540;660;700" dur="6.8s" repeatCount="indefinite"/><animate attributeName="cy" values="320;290;260;240;220" dur="6.8s" repeatCount="indefinite"/></circle>
            <circle cx="200" cy="280" r="5" fill="#06b6d4"><animate attributeName="cx" values="200;340;520;660;700" dur="7.2s" repeatCount="indefinite"/><animate attributeName="cy" values="280;260;240;225;220" dur="7.2s" repeatCount="indefinite"/></circle>
            <circle cx="240" cy="380" r="5" fill="#06b6d4"><animate attributeName="cx" values="240;380;540;660;700" dur="6.5s" repeatCount="indefinite"/><animate attributeName="cy" values="380;340;280;240;220" dur="6.5s" repeatCount="indefinite"/></circle>
          </g>
          <polyline points="120,420 200,380 280,340 360,315 440,290 520,270 600,250 680,238 760,230 800,228" fill="none" stroke="#f59e0b" stroke-width="2"/>
          <circle r="3" fill="#f59e0b"><animateMotion dur="6s" repeatCount="indefinite" path="M120,420 L200,380 L280,340 L360,315 L440,290 L520,270 L600,250 L680,238 L760,230 L800,228"/></circle>
        </svg>
      `
    }
  ];

  stages.forEach((s,i)=>{
    const item=document.createElement('div');
    item.className='stage-item';
    item.innerHTML=`<div class="dot"></div><div><div style="font-weight:800">${s.title}</div><div style="color:#cfe0ff">${s.summary}</div></div>`;
    item.addEventListener('click',()=>go(i));
    stageList.appendChild(item);
  });

  let idx=0, playing=false, timer=null;
  function render(){panel.innerHTML=stages[idx].render();[...stageList.children].forEach((el,i)=>el.classList.toggle('active',i===idx));}
  function go(i){idx=Math.max(0,Math.min(stages.length-1,i));render();}
  function next(){go(idx+1)}
  function prev(){go(idx-1)}
  function play(){if(playing)return pause();playing=true;timer=setInterval(()=>{if(idx>=stages.length-1){pause();return;}next();},3000)}
  function pause(){playing=false;if(timer)clearInterval(timer);timer=null}
  function reset(){pause();go(0)}

  
  document.addEventListener('keydown',e=>{if(e.key==='ArrowLeft')prev();if(e.key==='ArrowRight')next();if(e.key===' '){e.preventDefault();play();}if(e.key==='r'||e.key==='R')reset();});
  render();
  play();
})();
</script>

</body>
</html>

